(()=>{"use strict";class e{constructor(e,t){this._form=e,this._parameters=t}_showInputError=(e,t)=>{const{inputErrorClass:r,errorClass:n}=this._parameters,s=this._form.querySelector(`.${e.id}-error`);e.classList.add(r),s.textContent=t,s.classList.add(n)};hideInputError=e=>{const{inputErrorClass:t,errorClass:r}=this._parameters,n=this._form.querySelector(`.${e.id}-error`);e&&e.classList.remove(t),n&&(n.classList.remove(r),n.textContent=" ")};checkInputValidity=e=>{e.validity.valid?this.hideInputError(e):this._showInputError(e,e.validationMessage)};_hasInvalidInput=()=>this._inputList.some((e=>!e.validity.valid));_setEventListeners=()=>{this._inputList=Array.from(this._form.querySelectorAll(this._parameters.inputSelector)),this._submitButton=this._form.querySelector(this._parameters.submitButtonSelector),this.toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this.checkInputValidity(e),this.toggleButtonState()}))}))};toggleButtonState=()=>{this._hasInvalidInput()?(this._submitButton.classList.add(this._parameters.inactiveButtonClass),this._submitButton.disabled=!0):(this._submitButton.classList.remove(this._parameters.inactiveButtonClass),this._submitButton.disabled=!1)};enableValidation=()=>{this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()};resetErrorsForm=()=>{this.toggleButtonState(),this._inputList.forEach((e=>{this.hideInputError(e)}))}}class t{constructor(e,t,r){this._cardTemplate=document.querySelector(t).content,this._name=e.name,this._link=e.link,this._alt=`Изображение ${e.name}`,this._handleCardClick=r,this.getCardElement()}fillCard=()=>{this._cardElement.querySelector(".elements__name").textContent=this._name,this._cardImage.src=this._link,this._cardImage.alt=this._alt};handleDeleteCard=e=>{e.target.closest(".elements__card").remove()};handleLike=()=>{this._cardLikeButton.classList.toggle("elements__button-like_active")};_setEventListeners(){this._cardDeleteButton.addEventListener("click",this.handleDeleteCard),this._cardLikeButton.addEventListener("click",this.handleLike),this._cardImage.addEventListener("click",(()=>{this._handleCardClick(this._name,this._link,this._alt)}))}getCardElement(){return this._cardElement=this._cardTemplate.cloneNode(!0),this._cardDeleteButton=this._cardElement.querySelector(".elements__del"),this._cardImage=this._cardElement.querySelector(".elements__image"),this._cardLikeButton=this._cardElement.querySelector(".elements__button-like"),this.fillCard(),this._setEventListeners(),this._cardElement}}const r=document.querySelector(".profile__edit-button"),n=document.querySelector(".popup-profile"),s=n.querySelector(".popup__input_el_name"),o=n.querySelector(".popup__input_el_about-me"),i=document.querySelector(".profile__info-name"),a=document.querySelector(".profile__info-job"),l=document.querySelector(".profile__add-button"),c=document.querySelector(".popup-card"),u=c.querySelector(".popup__input_card-name"),p=c.querySelector(".popup__input_card-image"),d=n.querySelector(".popup__form-profile"),_=c.querySelector(".popup__form-card"),m=document.querySelector(".elements"),h=document.querySelector(".popup-image"),v=h.querySelector(".popup__image-card"),f=h.querySelector(".popup__caption");function y(e){e.classList.add("popup_opened"),document.addEventListener("keydown",g)}function E(e){e.classList.remove("popup_opened"),document.removeEventListener("keydown",g)}const S={};function k(e){const r=new t(e,".elements_template",L).getCardElement();m.prepend(r)}function L(e,t){v.src=t,v.alt=e,f.textContent=e,y(h)}function g(e){"Escape"===e.key&&E(document.querySelector(".popup_opened"))}var b;r.addEventListener("click",(function(){const e=d.getAttribute("name");S[e].resetErrorsForm(),s.value=i.textContent,o.value=a.textContent,y(n)})),d.addEventListener("submit",(function(e){e.preventDefault(),i.textContent=s.value,a.textContent=o.value,E(n)})),b={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inputErrorClass:"popup__input_type_error",inactiveButtonClass:"popup__button_disabled",errorClass:"popup__error_visible",fieldsetSelector:".popup__fieldset"},Array.from(document.querySelectorAll(b.formSelector)).forEach((t=>{const r=new e(t,b),n=t.getAttribute("name");S[n]=r,r.enableValidation()})),l.addEventListener("click",(()=>{!function(){_.reset();const e=_.getAttribute("name");S[e].resetErrorsForm(),y(c)}()})),_.addEventListener("submit",(function(e){e.preventDefault(),k({name:u.value,link:p.value}),E(c)})),[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}].forEach(k),Array.from(document.querySelectorAll(".popup")).forEach((e=>{e.addEventListener("mousedown",(function(t){const r=t.target.classList.contains("popup"),n=t.target.classList.contains("popup__close-button");(r||n)&&E(e)}))}))})();